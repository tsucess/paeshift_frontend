var D=(r,e,s)=>new Promise((o,n)=>{var i=f=>{try{d(s.next(f))}catch(b){n(b)}},u=f=>{try{d(s.throw(f))}catch(b){n(b)}},d=f=>f.done?o(f.value):Promise.resolve(f.value).then(i,u);d((s=s.apply(r,e)).next())});import{j as t}from"./index-DzfYAV6B.js";import{r as S,u as V,N as v}from"./router-vendor-nz_fvPt4.js";import{F as m,A as _,B as U,C as y,D as $}from"./icon-vendor-Y_MkwwPz.js";import{l as P}from"./logo-sm-CwMTbstP.js";import{a as g}from"./index-Cfc3znND.js";import{A as N}from"./config-B3zyxP14.js";let p=0;const K=[{id:p++,to:"../dashboard",title:"Dashboard",icon:t.jsxDEV(m,{className:"me-2",icon:_},void 0,!1,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebarroutes.jsx",lineNumber:12,columnNumber:9},void 0)},{id:p++,to:"../home",title:"Home",icon:t.jsxDEV(m,{className:"me-2",icon:_},void 0,!1,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebarroutes.jsx",lineNumber:18,columnNumber:9},void 0)},{id:p++,to:"../jobs",title:"Shifts",icon:t.jsxDEV(m,{className:"me-2",icon:U},void 0,!1,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebarroutes.jsx",lineNumber:24,columnNumber:9},void 0),role:"admin"},{id:p++,to:"../settings",title:"Settings",icon:t.jsxDEV(m,{className:"me-2",icon:y},void 0,!1,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebarroutes.jsx",lineNumber:31,columnNumber:9},void 0),role:"admin"}],F=[{id:p++,to:"../dashboard",title:"Dashboard",icon:t.jsxDEV(m,{className:"me-2",icon:_},void 0,!1,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebarroutes.jsx",lineNumber:41,columnNumber:9},void 0)},{id:p++,to:"../home",title:"Home",icon:t.jsxDEV(m,{className:"me-2",icon:_},void 0,!1,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebarroutes.jsx",lineNumber:47,columnNumber:9},void 0)},{id:p++,to:"../jobs",title:"Shifts",icon:t.jsxDEV(m,{className:"me-2",icon:U},void 0,!1,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebarroutes.jsx",lineNumber:53,columnNumber:9},void 0),role:"admin"},{id:p++,to:"../settings",title:"Settings",icon:t.jsxDEV(m,{className:"me-2",icon:y},void 0,!1,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebarroutes.jsx",lineNumber:60,columnNumber:9},void 0),role:"admin"}],te="/assets/profile-Pd_qmAeR.png";var x={},w={},R;function O(){return R||(R=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});var e="fas",s="xmark",o=384,n=512,i=[128473,10005,10006,10060,215,"close","multiply","remove","times"],u="f00d",d="M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z";r.definition={prefix:e,iconName:s,icon:[o,n,i,u,d]},r.faXmark=r.definition,r.prefix=e,r.iconName=s,r.width=o,r.height=n,r.ligatures=i,r.unicode=u,r.svgPathData=d,r.aliases=i}(w)),w}var C;function B(){return C||(C=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=O();r.definition={prefix:e.prefix,iconName:e.iconName,icon:[e.width,e.height,e.aliases,e.unicode,e.svgPathData]},r.faClose=r.definition,r.prefix=e.prefix,r.iconName=e.iconName,r.width=e.width,r.height=e.height,r.ligatures=e.aliases,r.unicode=e.unicode,r.svgPathData=e.svgPathData,r.aliases=e.aliases}(x)),x}var L=B();const oe=()=>{let[r,e]=S.useState(""),s=V();const[o,n]=S.useState(""),i=localStorage.getItem("access_token"),u=localStorage.getItem("user_role");if(!i)return window.location.href="/signin",null;const d=localStorage.getItem("user_id");S.useEffect(()=>{D(null,null,function*(){var l;try{d||s("../signin");const h=yield g.get(`${N}/accountsapp/whoami/${d}`);e(h.data)}catch(h){return console.error("Error fetching user:",((l=h.response)==null?void 0:l.data)||h.message),null}}),g.get(`${N}/accountsapp/user_profile_pictures_full/?user_id=${d}`).then(l=>{n(l.data[0].url)}).catch(l=>console.error("Profile Image error:",l))},[]);const f=()=>{g.post(`${N}/accountsapp/logout`).then(c=>{localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user_id"),localStorage.removeItem("user_role"),s("../signin")}).catch(c=>console.error("Logout error:",c))},b=(c,l)=>{const h=l==="client"?"applicant":"client",I={user_id:c,new_role:h};g.put(`${N}/accountsapp/switch-role`,I).then(E=>{localStorage.setItem("user_role",h),window.location.reload()}).catch(E=>console.error("Switch role error:",E))};return t.jsxDEV("section",{className:"container_sidebar",children:t.jsxDEV("nav",{id:"sidebarMenu",className:"col-12 col-md-4 col-lg-3 col-xl-2 d-lg-block sidebar collapse p-3 p-md-1 p-lg-3 pt-4",children:t.jsxDEV("div",{className:"position-sticky sidebar-sticky bg-white",children:[t.jsxDEV("div",{className:"sidebar-brand",children:[t.jsxDEV(v,{to:"../",children:t.jsxDEV("img",{src:P,className:"brand-logo",alt:"Paeshift logo"},void 0,!1,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebar.jsx",lineNumber:105,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebar.jsx",lineNumber:104,columnNumber:13},void 0),t.jsxDEV("button",{className:"navbar-toggler position-absolute d-lg-none collapsed",type:"button","data-bs-toggle":"collapse","data-bs-target":"#sidebarMenu","aria-controls":"sidebarMenu","aria-expanded":"false","aria-label":"Toggle navigation",children:t.jsxDEV(m,{className:"icon-close",icon:L.faClose},void 0,!1,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebar.jsx",lineNumber:116,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebar.jsx",lineNumber:107,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebar.jsx",lineNumber:103,columnNumber:11},void 0),t.jsxDEV("ul",{className:"nav flex-column mt-4",children:[u==="client"&&K.map((c,l)=>c.title!=="Home"?t.jsxDEV("li",{style:{display:"block"},className:"nav-item",children:t.jsxDEV(v,{className:c.current?"nav-link active":"nav-link","aria-current":"page",to:c.to,children:[c.icon," ",c.title]},void 0,!0,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebar.jsx",lineNumber:128,columnNumber:23},void 0)},l,!1,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebar.jsx",lineNumber:125,columnNumber:21},void 0):""),u==="applicant"&&F.map((c,l)=>c.title!=="Dashboard"?t.jsxDEV("li",{style:{display:"block"},className:"nav-item",children:t.jsxDEV(v,{className:c.current?"nav-link active":"nav-link","aria-current":"page",to:c.to,children:[c.icon," ",c.title]},void 0,!0,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebar.jsx",lineNumber:150,columnNumber:23},void 0)},l,!1,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebar.jsx",lineNumber:147,columnNumber:21},void 0):"")]},void 0,!0,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebar.jsx",lineNumber:119,columnNumber:11},void 0),t.jsxDEV("div",{className:"profile-logout",children:[t.jsxDEV("div",{className:"profile",children:[t.jsxDEV("div",{className:"profile-dp",children:t.jsxDEV("img",{src:`${N}${o}`,alt:"profile"},void 0,!1,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebar.jsx",lineNumber:173,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebar.jsx",lineNumber:171,columnNumber:15},void 0),t.jsxDEV("div",{className:"profile-info",children:[t.jsxDEV("h2",{children:r.username},void 0,!1,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebar.jsx",lineNumber:176,columnNumber:17},void 0),t.jsxDEV("p",{children:r.role},void 0,!1,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebar.jsx",lineNumber:177,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebar.jsx",lineNumber:175,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebar.jsx",lineNumber:170,columnNumber:13},void 0),t.jsxDEV("ul",{className:"nav flex-column logout-link",children:[t.jsxDEV("li",{className:"nav-item my-2",children:t.jsxDEV("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",background:"#f6f5ff",borderRadius:"4px",padding:"8px 12px",marginBottom:"8px"},children:[t.jsxDEV("span",{style:{fontWeight:"bold",color:"#5E0096"},children:u==="client"?"Client":"Applicant"},void 0,!1,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebar.jsx",lineNumber:183,columnNumber:19},void 0),t.jsxDEV("label",{className:"switch",style:{margin:0},children:[t.jsxDEV("input",{type:"checkbox",checked:u==="applicant",onChange:()=>b(d,u)},void 0,!1,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebar.jsx",lineNumber:187,columnNumber:21},void 0),t.jsxDEV("span",{className:"slider round",style:{backgroundColor:"#5E0096"}},void 0,!1,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebar.jsx",lineNumber:192,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebar.jsx",lineNumber:186,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebar.jsx",lineNumber:182,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebar.jsx",lineNumber:181,columnNumber:15},void 0),t.jsxDEV("li",{className:"nav-item my-2",children:t.jsxDEV(v,{className:"nav-link logout",onClick:()=>f(),"aria-current":"page",children:[t.jsxDEV(m,{className:"me-2",icon:$},void 0,!1,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebar.jsx",lineNumber:200,columnNumber:19},void 0)," ",t.jsxDEV("p",{children:" Logout"},void 0,!1,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebar.jsx",lineNumber:200,columnNumber:87},void 0)]},void 0,!0,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebar.jsx",lineNumber:199,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebar.jsx",lineNumber:198,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebar.jsx",lineNumber:180,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebar.jsx",lineNumber:169,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebar.jsx",lineNumber:102,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebar.jsx",lineNumber:101,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/Rise Networks/Documents/paeshift_project/paeshift-frontend/src/components/sidebar/Sidebar.jsx",lineNumber:100,columnNumber:5},void 0)},ne="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAANCAYAAACdKY9CAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADmSURBVHgBvVC7DcJADH0+oKPIBmQDGIENoEZ8W6iyAUxAJBRaQAyAmADYgBGyAbQUueMdSZSQpES4uXe23/OzgV9EH2tniG2/qqaqkk00fBZOQ2y6xVo9BSMEUwFcA2mLHcIQqAmfa54gKRgjePDrJN+QEzxNogFagDkcsdh/WaLyKsNmxeY14UVgbgLplnY4Yu5bZQPtJSmXVN9a1DDPEmGAoKMQzZjqUXGXOHbsPupDLhAUxI0gPcIzcopxTfslQh2vaw1yiK3JOU+gUCfrS2IPz6re46X1nSd1OXUZQfPUJsTf4g11qz+TJigE3QAAAABJRU5ErkJggg==";class j extends Error{}j.prototype.name="InvalidTokenError";function Q(r){return decodeURIComponent(atob(r).replace(/(.)/g,(e,s)=>{let o=s.charCodeAt(0).toString(16).toUpperCase();return o.length<2&&(o="0"+o),"%"+o}))}function X(r){let e=r.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return Q(e)}catch(s){return atob(e)}}function J(r,e){if(typeof r!="string")throw new j("Invalid token specified: must be a string");e||(e={});const s=e.header===!0?0:1,o=r.split(".")[s];if(typeof o!="string")throw new j(`Invalid token specified: missing part #${s+1}`);let n;try{n=X(o)}catch(i){throw new j(`Invalid token specified: invalid base64 for part #${s+1} (${i.message})`)}try{return JSON.parse(n)}catch(i){throw new j(`Invalid token specified: invalid json for part #${s+1} (${i.message})`)}}const M=!0,T=!1;class q{constructor(){this.isDev=M,this.isDebug=T}info(...e){this.isDev&&console.log("[INFO]",...e)}debug(...e){this.isDev&&this.isDebug&&console.debug("[DEBUG]",...e)}warn(...e){console.warn("[WARN]",...e)}error(...e){console.error("[ERROR]",...e)}apiResponse(e,s){this.isDev&&(console.group(`[API] ${e}`),console.log("Response:",s),console.groupEnd())}apiError(e,s){console.group(`[API ERROR] ${e}`),console.error("Error:",s),s.response&&(console.error("Status:",s.response.status),console.error("Data:",s.response.data)),console.groupEnd()}userAction(e,s={}){this.isDev&&console.log(`[USER ACTION] ${e}`,s)}time(e){this.isDev&&console.time(`[PERF] ${e}`)}timeEnd(e){this.isDev&&console.timeEnd(`[PERF] ${e}`)}}const a=new q,G="paeshift_";class Y{constructor(){this.prefix=G}encrypt(e){try{const s=JSON.stringify(e);return btoa(s)}catch(s){return a.error("Encryption failed:",s),null}}decrypt(e){try{const s=atob(e);return JSON.parse(s)}catch(s){return a.error("Decryption failed:",s),null}}getKey(e){return`${this.prefix}${e}`}setItem(e,s){try{const o=this.getKey(e),n=this.encrypt(s);return n?(localStorage.setItem(o,n),a.debug(`Stored item: ${e}`),!0):!1}catch(o){return a.error(`Failed to store item ${e}:`,o),!1}}getItem(e){try{const s=this.getKey(e),o=localStorage.getItem(s);if(!o)return null;const n=this.decrypt(o);return a.debug(`Retrieved item: ${e}`),n}catch(s){return a.error(`Failed to retrieve item ${e}:`,s),null}}removeItem(e){try{const s=this.getKey(e);return localStorage.removeItem(s),a.debug(`Removed item: ${e}`),!0}catch(s){return a.error(`Failed to remove item ${e}:`,s),!1}}clear(){try{const s=Object.keys(localStorage).filter(o=>o.startsWith(this.prefix));return s.forEach(o=>{localStorage.removeItem(o)}),a.debug(`Cleared ${s.length} items from storage`),!0}catch(e){return a.error("Failed to clear storage:",e),!1}}hasItem(e){const s=this.getKey(e);return localStorage.getItem(s)!==null}getAllKeys(){try{return Object.keys(localStorage).filter(s=>s.startsWith(this.prefix)).map(s=>s.replace(this.prefix,""))}catch(e){return a.error("Failed to get all keys:",e),[]}}setAuthData(e){const s=this.setItem("auth",{access_token:e.access_token,refresh_token:e.refresh_token,user_id:e.user_id,role:e.role,email:e.email,first_name:e.first_name,last_name:e.last_name,timestamp:Date.now()});return s&&a.info("Authentication data stored successfully"),s}getAuthData(){const e=this.getItem("auth");if(e&&e.timestamp){const s=Date.now()-e.timestamp,o=24*60*60*1e3;if(s>o)return a.warn("Authentication token expired"),this.clearAuthData(),null}return e}clearAuthData(){this.removeItem("auth"),a.info("Authentication data cleared")}isAuthenticated(){const e=this.getAuthData();return e&&e.access_token&&e.user_id}}const A=new Y,ae=r=>D(null,null,function*(){var e;try{const s=A.getAuthData();if(s&&s.user_id&&s.access_token)return a.debug("Using auth data from secure storage"),yield k(s.user_id,s.access_token,r);const o=localStorage.getItem("user_id"),n=localStorage.getItem("access_token");if(!o){if(a.info("No user_id found in storage"),n)try{const i=J(n);if(i&&i.user_id)return a.debug("Retrieved user_id from token:",i.user_id),localStorage.setItem("user_id",i.user_id),yield k(i.user_id,n,r)}catch(i){a.error("Error decoding token:",i.message),localStorage.removeItem("access_token")}return null}return yield k(o,n,r)}catch(s){return a.error("Error in getCurrentUser:",((e=s.response)==null?void 0:e.data)||s.message),null}}),k=(r,e,s)=>D(null,null,function*(){try{const o={};e&&(o.Authorization=`Bearer ${e}`);const n=yield g.get(`http://127.0.0.1:8000/accountsapp/whoami/${r}`,{headers:o});if(n.data){a.apiResponse(`/accountsapp/whoami/${r}`,n.data),s&&typeof s=="function"&&s(n.data);const i={access_token:e,user_id:r,first_name:n.data.first_name,last_name:n.data.last_name,email:n.data.email,role:n.data.role};return A.setAuthData(i),n.data.first_name&&localStorage.setItem("first_name",n.data.first_name),n.data.last_name&&localStorage.setItem("last_name",n.data.last_name),n.data.email&&localStorage.setItem("user_email",n.data.email),n.data.role&&localStorage.setItem("user_role",n.data.role),n.data}return null}catch(o){return a.apiError(`/accountsapp/whoami/${r}`,o),o.response&&(o.response.status===401||o.response.status===404)&&(a.warn("Clearing invalid credentials"),A.clearAuthData(),localStorage.removeItem("access_token"),localStorage.removeItem("user_id")),null}}),ie=r=>{const e=Math.floor(r),s=Math.round((r-e)*60);return s>0?`${e} hr${e!==1?"s":""} ${s} min${s!==1?"s":""}`:`${e} hr${e!==1?"s":""}`};export{ie as C,te as P,ne as S,oe as a,ae as g,a as l};
